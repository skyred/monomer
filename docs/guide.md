# Guide to Building Drupal Themes with Web Components (Polymer based)

## Wrapper elements vs. Blackbox elements

 - Blackbox elements are those that encapsulate everything, including styling and behaviours, and only provide a few simple arguments for input. 
 Examples include video player, responsive image, "fancy button" etc. 
 
 - Wrapper elements are those that provides acts as a wrapper of content output by other parts of the system. For example, a "region" element in Drupal might
 contain any content generated by Drupal, including nodes and blocks. Such nature means that wrapper elements cannot have too much assumption about what 
 it will contain and need to be universal, which limits what they can encapsulate. However, wrapper elements can still encapsulate styling and the "wrapping part" 
 (e.g. border and padding). In practice, wrapper elements are often used with LightDOM children, `<content>` and/or [`<slot>`](https://webkit.org/blog/4096/introducing-shadow-dom-api/) to form a composed DOM.
  
Although in a web app, it is ideal to build blackbox elements; in designing a Drupal theme, it is more common that you would work with wrapper elements.

## Creating Polymer element and using it in Twig templates
`my-element/mm-region/mm-region.html`:
```html
<link rel="import" href="../polymer/polymer.html">  <!-- Always use "canonical url"-->
<dom-module id="mm-region">
  <template>
    <style>
      /* Put CSS here */
    </style>
    <content></content>
  </template>
<script>
  Polymer({
    is: 'mm-region',
    properties: { // Data attributes / argument
      name: String,
      hidden: {
        type: Boolean,
        value: false,
      }
    },
    ready: function () {
      // JavaScript code to run when the element is ready (loaded on the page).
    }
  });
</script>
</dom-module>
```

  >  Note: always use relative URL like "../package-name/element-name.html" in your Polymer elements. Do NOT put "bower_components/" or "my-elements/" in the path.


See also: [Element project layout](https://www.polymer-project.org/1.0/docs/tools/polymer-cli#element-project-layout) | [Local DOM](https://www.polymer-project.org/1.0/start/first-element/step-2) | [Lifecycle callbacks](https://www.polymer-project.org/1.0/docs/devguide/registering-elements#lifecycle-callbacks)

In your Twig template (where you want to put your element), use the following:
```twig
{% polymer import 'mm-region/mm-region.html' %}  {# this will add a <link> to the page #}
<mm-region{{ attributes }}
          {{ !active ? 'hidden="true"' }}        {# Tip: do not put a conditional attribute as the last attribute #}
          name="{{ name ]}">
{{ content }} 
</mm-region>
```

## CSS styling
### Style module
To simply code and to reuse styling, you may put CSS in a seperate element called "style module" and reference it in your main element.

`my-element/mm-region/mm-region-styles.html`:
```html
<link rel="import" href="../polymer/polymer.html">
<dom-module id="mm-region-styles">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
  </template>
</dom-module>
```

`my-element/mm-region/mm-region.html`:
```html
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="mm-region-styles.html">

<dom-module id="mm-region">
  <template>
    <style include="mm-region-styles"></style>
    ...
  </template>
...
</dom-module>

```

See also: [Shared style](https://www.polymer-project.org/1.0/docs/devguide/styling#style-modules)

### CSS selectors for Web Components
There are some special selectors for styling Web Components and their children. These selectors are what allows us to encapsulate 
styling inside an element.

 1. #### :host and :host-context
  `:host` refers to the element itself.
```css
  :host {
    display: block; 
    background: #fff;
  }
  
  :host([hidden]) {
    display: none;
  } 
  /* This matches elements like: <mm-region hidden> </mm-region> */
```
  > Tip: Web Components are by default `inline`. However in designing a theme, most of the time we need `block`. 
  So, remember to write `display: block` in `:host`. 
  
  `host-context` matches whatever class/id/attributes on the element or its parent(s):
```css
  :host-context(.main-content) {
    display: block;
    font-size: 2em;
  }
  /* This matches elements like:
    <div class="main-content">
      <mm-region>
      </mm-region>
    </div>
  */
```  
 2. #### ::content
  Select LightDOM children of an element. Example:
```css
  ::content #header{
    background: green;
  }
  
  /**
  This matches:
  <mm-region>
    <div id="header">Title</div> <!--Matched element-->
  </mm-region>
  **/
```

 > Note: In native ShadowDOM ::content works. However, Polymer's ShadyDOM (polyfill implementation) requires that
  "you must have a selector to the left of the ::content pseudo-element".
  A workaround is to multiple selectors:
   ```css
     :host::content #header,
     ::content #header {
       ...
     }
   ```
 > See more at [Polymer Documentation](https://www.polymer-project.org/1.0/docs/devguide/styling#styling-distributed-children-content).

See also: [ShadowDOM CSS cheat sheet](http://robdodson.me/shadow-dom-css-cheat-sheet/)

